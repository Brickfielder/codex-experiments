---
import BaseLayout from '../layouts/BaseLayout.astro';
import AddPaperClient from '../components/add/AddPaperClient.tsx';
import { resolveWithBase } from '~/utils/paths';
const apiUrl = resolveWithBase('/api/papers/add.json');
---

<BaseLayout title="Add a paper" description="Fetch paper metadata by DOI or PubMed ID">
  <section class="mx-auto max-w-4xl space-y-10 px-4 py-12 sm:px-6 lg:px-8">
    <div class="space-y-4 text-center">
      <p class="inline-flex items-center gap-2 rounded-full bg-indigo-50 px-4 py-1 text-sm font-semibold text-indigo-700">
        <span class="inline-flex h-8 w-8 items-center justify-center rounded-full bg-indigo-600 text-white shadow-md">
          <svg aria-hidden="true" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 4h10a2 2 0 012 2v10a2 2 0 01-2 2H7a2 2 0 01-2-2V9a2 2 0 012-2zm4 4h2" />
          </svg>
        </span>
        Curate the repository
      </p>
      <h1 class="text-4xl font-semibold tracking-tight text-slate-900">Add research by DOI or PubMed ID</h1>
      <p class="text-lg leading-relaxed text-slate-600">
        Look up peer-reviewed papers directly from Crossref and PubMed, review the returned metadata, and commit them to the
        repository datasets with one click.
      </p>
    </div>

    <AddPaperClient client:load apiUrl={apiUrl} />

    <div class="rounded-3xl border border-white/60 bg-white/70 p-6 text-sm text-slate-600 shadow-lg ring-1 ring-indigo-100 backdrop-blur dark:border-slate-800 dark:bg-slate-900 dark:text-slate-300 dark:ring-slate-800/80">
      <h2 class="text-base font-semibold text-slate-900 dark:text-slate-100">How it works</h2>
      <ol class="mt-3 list-decimal space-y-2 pl-6">
        <li>Paste a DOI or PubMed ID and choose whether you want to preview or persist the result.</li>
        <li>The tool merges Crossref and PubMed metadata, checking for duplicates before writing.</li>
        <li>On success the raw and normalized datasets in <code>data/</code> are updated, ready for commit.</li>
      </ol>
      <p class="mt-4">
        Prefer the command line? Run <code>npm run add:paper -- --doi &lt;value&gt;</code> or <code>--pmid &lt;value&gt;</code> to
        perform the same workflow locally.
      </p>
    </div>
  </section>
</BaseLayout>
