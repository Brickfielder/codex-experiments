---
import BaseLayout from '../layouts/BaseLayout.astro';

const basePath = import.meta.env.BASE_URL;
const normalizedBasePath = basePath.endsWith('/') ? basePath : `${basePath}/`;
const basePathJson = JSON.stringify(normalizedBasePath);
---

<BaseLayout
  title="Ongoing Studies in Cardiac Arrest Survivorship"
  description="Summaries of ongoing survivorship studies, rehabilitation programs, and psychoeducation trials."
>
  <div class="mx-auto max-w-5xl space-y-16">
    <section class="space-y-4">
      <h1 class="text-3xl font-bold text-slate-900 dark:text-white">
        Ongoing Studies in Cardiac Arrest Survivorship
      </h1>
      <p class="text-lg leading-relaxed text-slate-600 dark:text-slate-200">
        This page highlights selected ongoing research projects focused on life after cardiac arrest
        â€“ including rehabilitation, psychoeducation, self-management and support for survivors and
        their families. It is for information only and does not provide medical advice or a direct
        route into any study.
      </p>
      <p
        id="ongoing-studies-updated"
        class="text-sm font-medium text-slate-500 dark:text-slate-300"
      >
      </p>
    </section>

    <section class="space-y-4">
      <div class="space-y-2">
        <h2 class="text-2xl font-semibold text-slate-900 dark:text-white">At a glance</h2>
        <p class="text-slate-600 dark:text-slate-200">
          Use this overview to quickly compare populations, focus and format across studies. Click
          on a study name to jump to its detailed summary.
        </p>
      </div>
      <div
        class="overflow-x-auto rounded-2xl border border-slate-200 bg-white p-2 shadow-sm dark:border-slate-800 dark:bg-slate-900"
      >
        <table class="table--studies text-sm leading-relaxed">
          <thead class="text-left text-slate-500 dark:text-slate-300">
            <tr>
              <th>Study</th>
              <th>Countries / setting</th>
              <th>Target group</th>
              <th>Main focus</th>
              <th>Format</th>
              <th>Status</th>
              <th>Links</th>
            </tr>
          </thead>
          <tbody id="studies-table-body"></tbody>
        </table>
      </div>
    </section>

    <section class="space-y-6">
      <h2 class="text-2xl font-semibold text-slate-900 dark:text-white">Study summaries</h2>
      <div id="studies-cards" class="space-y-6"></div>
    </section>

    <section class="space-y-3">
      <h2 class="text-2xl font-semibold text-slate-900 dark:text-white">Notes &amp; disclaimer</h2>
      <p class="text-slate-600 dark:text-slate-200">
        This list focuses on survivorship-oriented studies and is not exhaustive of all cardiac
        arrest research. Study status and eligibility criteria may change; please refer to the
        linked protocol or trial registry pages for the most up-to-date information.
      </p>
      <p class="text-slate-600 dark:text-slate-200">
        If you are interested in taking part in research, please discuss this with your clinical
        team or follow the instructions on the linked study or registry pages.
      </p>
    </section>
  </div>

  <script is:inline set:html={`// Expose the resolved base path so the client script can build absolute URLs
window.__BASE_PATH__ = ${basePathJson};`}></script>
  <script src={`${normalizedBasePath}assets/js/ongoing-studies.js`} defer></script>
</BaseLayout>
