---
import ThemeToggle from '../components/ThemeToggle.astro';
import { resolveWithBase } from '~/utils/paths';
import { getAboutUrl, getBrowseUrl, getCollaborateUrl, getSiteUrl } from '~/utils/siteUrls';
import '../styles/global.css';
const {
  title = 'OHCA Survivorship Repository',
  description = 'Knowledge hub for survivorship after cardiac arrest'
} = Astro.props;
const homeHref = getSiteUrl();
const browseHref = getBrowseUrl();
const aboutHref = getAboutUrl();
const rssHref = resolveWithBase('/feed.xml');
const jsonFeedHref = resolveWithBase('/feed.json');
const apiHref = resolveWithBase('/api/papers.json');
const collaborateHref = getCollaborateUrl();
---

<!doctype html>
<html lang="en" class="min-h-full">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
  </head>
  <body class="min-h-screen">
    <a
      href="#main"
      class="sr-only focus:not-sr-only focus:absolute focus:left-4 focus:top-4 focus:rounded-md focus:bg-blue-600 focus:px-3 focus:py-2 focus:text-white"
    >
      Skip to content
    </a>
    <header
      class="relative overflow-hidden rounded-b-3xl bg-gradient-to-br from-indigo-600 via-purple-600 to-sky-500 text-white shadow-xl"
    >
      <div
        class="absolute inset-0 bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.25),_transparent_60%)]"
      >
      </div>
      <div class="relative mx-auto flex max-w-6xl flex-col gap-6 px-4 py-6 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between gap-4">
          <a class="flex items-center gap-3" href={homeHref}>
            <span
              class="flex h-12 w-12 items-center justify-center rounded-2xl bg-white/20 shadow-inner"
            >
              <svg
                aria-hidden="true"
                class="h-7 w-7 text-white"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  d="M12 21c-.3 0-.6-.1-.8-.3-3.4-3-5.7-5.3-7-7.2C2.7 12.1 2 10.6 2 8.8 2 5.6 4.6 3 7.8 3c1.6 0 3 .6 4.2 1.7C13.2 3.6 14.6 3 16.2 3 19.4 3 22 5.6 22 8.8c0 1.8-.7 3.3-2.2 4.7-1.3 1.9-3.6 4.2-7 7.2-.2.2-.5.3-.8.3z"
                ></path>
              </svg>
            </span>
            <div>
              <span class="block text-xs font-semibold uppercase tracking-[0.3em] text-white/70">
                OHCA Survivorship
              </span>
              <span class="text-xl font-semibold">Repository</span>
            </div>
          </a>
          <div class="flex items-center gap-4">
            <nav
              class="hidden items-center gap-6 text-sm font-semibold text-white/90 md:flex"
              aria-label="Primary"
            >
              <a class="text-white transition hover:text-white/90" href={browseHref}>Browse</a>
              <a class="text-white transition hover:text-white/90" href={aboutHref}>About</a>
              <a class="text-white transition hover:text-white/90" href={collaborateHref}>Collaborate</a>
            </nav>
            <div class="rounded-full border border-white/40 bg-white/10 p-1 shadow-inner">
              <ThemeToggle />
            </div>
            <button class="md:hidden" type="button" aria-label="Toggle navigation" data-mobile-nav>
              <svg
                aria-hidden="true"
                class="h-6 w-6 text-white"
                fill="none"
                stroke="currentColor"
                stroke-width="1.8"
                viewBox="0 0 24 24"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M4 7h16M4 12h16M4 17h16"
                ></path>
              </svg>
            </button>
          </div>
        </div>
        <nav
          class="hidden flex flex-col gap-4 rounded-2xl border border-white/20 bg-white/10 p-4 text-sm font-medium text-white/80 shadow-lg backdrop-blur md:hidden"
          aria-label="Mobile"
          data-mobile-panel
        >
          <a
            class="rounded-xl bg-white/10 px-4 py-2 text-center text-white transition hover:bg-white/20"
            href={browseHref}>Browse</a
          >
          <a
            class="rounded-xl bg-white/10 px-4 py-2 text-center text-white transition hover:bg-white/20"
            href={aboutHref}>About</a
          >
          <a
            class="rounded-xl bg-white/10 px-4 py-2 text-center text-white transition hover:bg-white/20"
            href={collaborateHref}>Collaborate</a
          >
        </nav>
      </div>
    </header>
    <main id="main">
      <slot />
    </main>
    <footer class="mt-16 bg-slate-900/95 py-12 text-sm text-slate-300">
      <div
        class="mx-auto flex max-w-6xl flex-col gap-6 px-4 sm:flex-row sm:items-center sm:justify-between sm:px-6 lg:px-8"
      >
        <div>
          <p class="text-base font-semibold text-white">
            &copy; {new Date().getFullYear()} OHCA Survivorship Repository
          </p>
          <p class="mt-1 text-slate-400">
            Supporting research in cardiac arrest survival and recovery.
          </p>
        </div>
        <div class="flex flex-wrap gap-4 text-slate-400">
          <a class="transition hover:text-white" href={rssHref}>RSS</a>
          <a class="transition hover:text-white" href={jsonFeedHref}>JSON Feed</a>
          <a class="transition hover:text-white" href={apiHref}>API</a>
        </div>
      </div>
    </footer>
    <script is:inline>
      const mobileToggle = document.querySelector('[data-mobile-nav]');
      const mobilePanel = document.querySelector('[data-mobile-panel]');
      mobileToggle?.addEventListener('click', () => {
        mobilePanel?.classList.toggle('hidden');
      });
    </script>
  </body>
</html>
